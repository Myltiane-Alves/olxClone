{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Myltiane\\\\olxfrontend\\\\frontend\\\\src\\\\pages\\\\AddAd\\\\index.js\";\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport MaskedInput from 'react-text-mask';\nimport createNumberMask from 'text-mask-addons/dist/createNumberMask';\nimport { PageArea } from './styled';\nimport useApi from '../../helpers/OlxAPI';\nimport { PageContainer, PageTitle, ErrorMessage } from '../../components/MainComponents';\n\nconst Page = () => {\n  const api = useApi();\n  const fileField = useRef();\n  const history = useHistory();\n  const [categories, setCategories] = useState([]);\n  const [title, setTitle] = useState('');\n  const [category, setCategory] = useState('');\n  const [price, setPrice] = useState('');\n  const [priceNegotiable, setPriceNegotiable] = useState(false);\n  const [desc, setDesc] = useState('');\n  const [disabled, setDisabled] = useState(false);\n  const [error, setError] = useState('');\n  useEffect(() => {\n    const getCategories = async () => {\n      const cats = await api.getCategories();\n      setCategories(cats);\n    };\n\n    getCategories();\n  }, []);\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setDisabled(true);\n    setError('');\n    let errors = [];\n\n    if (!title.trim()) {\n      errors.push('Sem tÃ­tulo');\n    }\n\n    if (!category) {\n      errors.push('Sem categoria');\n    }\n\n    if (errors.length === 0) {\n      const fData = new FormData();\n      fData.append('title', title);\n      fData.append('price', price);\n      fData.append('priceneg', priceNegotiable);\n      fData.append('desc', desc);\n      fData.append('cat', category);\n\n      if (fileField.current.files.length > 0) {\n        for (let i = 0; i < fileField.current.files.length; i++) {\n          fData.append('img', fileField.current.files[i]);\n        }\n      }\n\n      const json = await api.addAd(fData);\n\n      if (!json.error) {\n        history.push(`/ad/${json.id}`);\n        return;\n      } else {\n        setError(json.error);\n      }\n    } else {\n      setError(errors.join(\"\\n\"));\n    }\n\n    setDisabled(false);\n  };\n\n  const priceMask = createNumberMask({\n    prefix: 'R$ ',\n    includeThousandsSeparator: true,\n    thousandsSeparatorSymbol: '.',\n    allowDecimal: true,\n    decimalSymbol: ','\n  });\n  return /*#__PURE__*/React.createElement(PageContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(PageTitle, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }\n  }, \"Postar um an\\xFAncio\"), /*#__PURE__*/React.createElement(PageArea, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }\n  }, error && /*#__PURE__*/React.createElement(ErrorMessage, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 21\n    }\n  }, error), /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    className: \"area\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"area--title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 25\n    }\n  }, \"Titulo\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"area--input\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    disabled: disabled,\n    value: title,\n    onChange: e => setTitle(e.target.value),\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 29\n    }\n  }))), /*#__PURE__*/React.createElement(\"label\", {\n    className: \"area\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"area--title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 25\n    }\n  }, \"Categoria\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"area--input\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"select\", {\n    disabled: disabled,\n    onChange: e => setCategory(e.target.value),\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 33\n    }\n  }), categories && categories.map(i => /*#__PURE__*/React.createElement(\"option\", {\n    key: i._id,\n    value: i._id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 37\n    }\n  }, i.name))))), /*#__PURE__*/React.createElement(\"label\", {\n    className: \"area\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"area--title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 25\n    }\n  }, \"Pre\\xE7o\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"area--input\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(MaskedInput, {\n    mask: priceMask,\n    placeholder: \"R$ \",\n    disabled: disabled || priceNegotiable,\n    value: price,\n    onChange: e => setPrice(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 29\n    }\n  }))), /*#__PURE__*/React.createElement(\"label\", {\n    className: \"area\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"area--title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 25\n    }\n  }, \"Pre\\xE7o Negoci\\xE1vel\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"area--input\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"checkbox\",\n    disabled: disabled,\n    checked: priceNegotiable,\n    onChange: e => setPriceNegotiable(!priceNegotiable),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 29\n    }\n  }))), /*#__PURE__*/React.createElement(\"label\", {\n    className: \"area\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"area--title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 25\n    }\n  }, \"Descri\\xE7\\xE3o\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"area--input\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"textarea\", {\n    disabled: disabled,\n    value: desc,\n    onChange: e => setDesc(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 29\n    }\n  }))), /*#__PURE__*/React.createElement(\"label\", {\n    className: \"area\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"area--title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 25\n    }\n  }, \"Imagens (1 ou mais)\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"area--input\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"file\",\n    disabled: disabled,\n    ref: fileField,\n    multiple: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 29\n    }\n  }))), /*#__PURE__*/React.createElement(\"label\", {\n    className: \"area\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"area--title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"area--input\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    disabled: disabled,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 29\n    }\n  }, \"Adicionar An\\xFAncio\"))))));\n};\n\nexport default Page;","map":{"version":3,"sources":["C:/Users/Myltiane/olxfrontend/frontend/src/pages/AddAd/index.js"],"names":["React","useState","useEffect","useRef","useHistory","MaskedInput","createNumberMask","PageArea","useApi","PageContainer","PageTitle","ErrorMessage","Page","api","fileField","history","categories","setCategories","title","setTitle","category","setCategory","price","setPrice","priceNegotiable","setPriceNegotiable","desc","setDesc","disabled","setDisabled","error","setError","getCategories","cats","handleSubmit","e","preventDefault","errors","trim","push","length","fData","FormData","append","current","files","i","json","addAd","id","join","priceMask","prefix","includeThousandsSeparator","thousandsSeparatorSymbol","allowDecimal","decimalSymbol","target","value","map","_id","name"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport MaskedInput from 'react-text-mask';\nimport createNumberMask from 'text-mask-addons/dist/createNumberMask';\nimport { PageArea } from './styled';\nimport useApi from '../../helpers/OlxAPI';\n\nimport { PageContainer, PageTitle, ErrorMessage } from '../../components/MainComponents';\n\nconst Page = () => {\n    const api = useApi();\n    const fileField = useRef();\n    const history = useHistory();\n\n    const [categories, setCategories] = useState([]);\n\n    const [title, setTitle] = useState('');\n    const [category, setCategory] = useState('');\n    const [price, setPrice] = useState('');\n    const [priceNegotiable, setPriceNegotiable] = useState(false);\n    const [desc, setDesc] = useState('');\n    \n    const [disabled, setDisabled] = useState(false);\n    const [error, setError] = useState('');\n\n    useEffect(()=>{\n        const getCategories = async ()=> {\n            const cats = await api.getCategories();\n            setCategories(cats);\n        }\n        getCategories();\n    }, []);\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        setDisabled(true);\n        setError('');\n        let errors = [];\n\n        if(!title.trim()) {\n            errors.push('Sem tÃ­tulo');\n        }\n\n        if(!category) {\n            errors.push('Sem categoria');\n        }\n\n        if(errors.length === 0) {\n            const fData = new FormData();\n            fData.append('title', title);\n            fData.append('price', price);\n            fData.append('priceneg', priceNegotiable);\n            fData.append('desc', desc);\n            fData.append('cat', category);\n\n            if(fileField.current.files.length > 0) {\n                for(let i=0;i<fileField.current.files.length;i++) {\n                    fData.append('img', fileField.current.files[i]);\n                }\n            }\n\n            const json = await api.addAd(fData);\n\n            if(!json.error) {\n                history.push(`/ad/${json.id}`);\n                return;\n            } else {\n                setError(json.error);\n            }\n\n        } else {\n            setError(errors.join(\"\\n\"));\n        }\n\n        setDisabled(false);\n    }\n\n    const priceMask = createNumberMask({\n        prefix:'R$ ',\n        includeThousandsSeparator:true,\n        thousandsSeparatorSymbol:'.',\n        allowDecimal:true,\n        decimalSymbol:','\n    });\n\n    return (\n        <PageContainer>\n            <PageTitle>Postar um anÃºncio</PageTitle>\n            <PageArea>\n                {error &&\n                    <ErrorMessage>{error}</ErrorMessage>\n                }\n\n                <form onSubmit={handleSubmit}>\n                    <label className=\"area\">\n                        <div className=\"area--title\">Titulo</div>\n                        <div className=\"area--input\">\n                            <input\n                                type=\"text\"\n                                disabled={disabled}\n                                value={title}\n                                onChange={e=>setTitle(e.target.value)}\n                                required\n                            />\n                        </div>\n                    </label>\n                    <label className=\"area\">\n                        <div className=\"area--title\">Categoria</div>\n                        <div className=\"area--input\">\n                            <select\n                                disabled={disabled}\n                                onChange={e=>setCategory(e.target.value)}\n                                required\n                            >\n                                <option></option>\n                                {categories && categories.map(i=>\n                                    <option key={i._id} value={i._id}>{i.name}</option>\n                                )}\n                            </select>\n                        </div>\n                    </label>\n                    <label className=\"area\">\n                        <div className=\"area--title\">PreÃ§o</div>\n                        <div className=\"area--input\">\n                            <MaskedInput\n                                mask={priceMask}\n                                placeholder=\"R$ \"\n                                disabled={disabled || priceNegotiable}\n                                value={price}\n                                onChange={e=>setPrice(e.target.value)}\n                            />\n                        </div>\n                    </label>\n                    <label className=\"area\">\n                        <div className=\"area--title\">PreÃ§o NegociÃ¡vel</div>\n                        <div className=\"area--input\">\n                            <input\n                                type=\"checkbox\"\n                                disabled={disabled}\n                                checked={priceNegotiable}\n                                onChange={e=>setPriceNegotiable(!priceNegotiable)}\n                            />\n                        </div>\n                    </label>\n                    <label className=\"area\">\n                        <div className=\"area--title\">DescriÃ§Ã£o</div>\n                        <div className=\"area--input\">\n                            <textarea\n                                disabled={disabled}\n                                value={desc}\n                                onChange={e=>setDesc(e.target.value)}\n                            ></textarea>\n                        </div>\n                    </label>\n                    <label className=\"area\">\n                        <div className=\"area--title\">Imagens (1 ou mais)</div>\n                        <div className=\"area--input\">\n                            <input\n                                type=\"file\"\n                                disabled={disabled}\n                                ref={fileField}\n                                multiple\n                            />\n                        </div>\n                    </label>\n                    <label className=\"area\">\n                        <div className=\"area--title\"></div>\n                        <div className=\"area--input\">\n                            <button disabled={disabled}>Adicionar AnÃºncio</button>\n                        </div>\n                    </label>\n                </form>\n            </PageArea>\n        </PageContainer>\n    );\n}\n\nexport default Page;"]},"metadata":{},"sourceType":"module"}